---
title:  | 
     ![](logo_DataIntelligence_normal.png){width=4in} \
     Unificaci√≥n de la data descargada del PJUD de Chile
author:
- name: Equipo DS
  affiliation: DataIntelligence
subtitle: | 
  <span style="color:green"> Corte de Apelaciones de Valdivia </span> 
  
header-includes:
   - \usepackage[]{babel}
output:
  rmdformats::html_clean:
    highlight: kate
    toc: true
    use_bookdown: true
    code_folding: "hide"    
    
# bibliography: references.bib 
---

<!-- http://openaccess.uoc.edu/webapps/o2/bitstream/10609/64085/6/romancalafatiTFG0617memoria.pdf -->

`r format(Sys.time(), "%d-%m-%Y")`
<style type="text/css">
.main-container {
  max-width: 1600px;
  margin-left: 100px;
  margin-right: auto;
}
</style>

```{r 1, message=FALSE, warning=FALSE, include = FALSE, echo = FALSE}
# suppressWarnings(library(RODBC))
library(ggplot2)
library(ggpubr)
library(markdown)
library(shiny)
library(shinythemes)
library(tidyverse)
library(magrittr)
library(lubridate)
library(plotly)
library(xts)
library(dygraphs)
library(kableExtra)
library(knitr)
library("readxl")
library(rsconnect)
library(dplyr)
library(summarytools)
library(epiDisplay)
#library(leaflet)
library(haven)
library(epiDisplay)
library("readxl")
library(expss)
library(hrbrthemes)
library(viridis)
library(viridisLite)
library(DescTools)
library(roperators)
library(shinycssloaders)
library(writexl)
library(labelled)
library(tidyverse)
library(haven)
library(readr)
library(sjmisc)
library(WriteXLS)
library(ineq)
library(readstata13)
library(reldist)
library(DT)
library(rio)
```

```{r 2, echo = FALSE}
archivos <- tibble(dir("Corte de Apelaciones de Valdivia/", pattern = ".xlsx"))
names(archivos)[1] <- "value"
```

```{r 3, echo = FALSE}
limite <- nrow(archivos)
output <- vector("list", length = limite)
for (i in 1:limite ) {
      tryCatch( {
  direccion <- paste0("Corte de Apelaciones de Valdivia/",archivos$value[i])
  cargado <- import(direccion) 
    columnas <- ""
    for (j in 1:ncol(cargado)) {
    columnas <- paste(columnas,colnames(cargado)[j],sep = "-")
    }
  output[[i]] <- columnas
      }, error = function(msg){ 
        print(direccion)})
}
combinaciones <- unique(as_tibble(unlist(output)))
```

```{r 4, warning=FALSE, error=FALSE, message=FALSE, echo = FALSE}
for (m in 1:nrow(combinaciones)) {
  assign(paste0("tabla_",m),"")     
}
for (i in archivos$value[1:nrow(archivos)]) {
        tryCatch(
      {
  direccion <- paste0("Corte de Apelaciones de Valdivia/",i)
  cargado <- read_xlsx(direccion)  
  
    columnas <- ""
    for (j in 1:ncol(cargado)) { 
    columnas <- paste(columnas,colnames(cargado)[j],sep = "-")
    } 
    if(columnas == combinaciones[1,1]){ tabla_1 <- rbind(tabla_1,cargado)}
    if(columnas == combinaciones[2,1]){ tabla_2 <- rbind(tabla_2,cargado)}
    if(columnas == combinaciones[3,1]){ tabla_3 <- rbind(tabla_3,cargado)}
    if(columnas == combinaciones[4,1]){ tabla_4 <- rbind(tabla_4,cargado)}
    if(columnas == combinaciones[5,1]){ tabla_5 <- rbind(tabla_5,cargado)}
    if(columnas == combinaciones[6,1]){ tabla_6 <- rbind(tabla_6,cargado)}
    if(columnas == combinaciones[7,1]){ tabla_7 <- rbind(tabla_7,cargado)}
    if(columnas == combinaciones[8,1]){ tabla_8 <- rbind(tabla_8,cargado)}
    if(columnas == combinaciones[9,1]){ tabla_9 <- rbind(tabla_9,cargado)} 
    if(columnas == combinaciones[10,1]){ tabla_10 <- rbind(tabla_10,cargado)} 
      }, error = function(msg){
        print(direccion)})
}
```

```{r 17, echo = FALSE}
write_xlsx(tabla_1,"tablas de CadAde Valdivia/tabla_1.xlsx")
write_xlsx(tabla_2,"tablas de CadAde Valdivia/tabla_2.xlsx")
write_xlsx(tabla_3,"tablas de CadAde Valdivia/tabla_3.xlsx")
write_xlsx(tabla_4,"tablas de CadAde Valdivia/tabla_4.xlsx")
write_xlsx(tabla_5,"tablas de CadAde Valdivia/tabla_5.xlsx")
write_xlsx(tabla_6,"tablas de CadAde Valdivia/tabla_6.xlsx")
write_xlsx(tabla_7,"tablas de CadAde Valdivia/tabla_7.xlsx")
write_xlsx(tabla_8,"tablas de CadAde Valdivia/tabla_8.xlsx")
write_xlsx(tabla_9,"tablas de CadAde Valdivia/tabla_9.xlsx") 
write_xlsx(tabla_10,"tablas de CadAde Valdivia/tabla_10.xlsx") 
```

